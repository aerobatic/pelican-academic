{% macro menu_item_href(menu_item, page_name, categories, site_url) -%}
  {% if menu_item.section and page_name == "index" %}#{{ menu_item.section }}
  {% elif menu_item.category %}
    {% for category, null in categories %}
      {% if category.name == menu_item.category %}{{ site_url }}/{{ category.url }}{% endif %}
    {% endfor %}
  {% elif menu_item.section and page_name != "index" %}/#{{ menu_item.section }}
  {% endif %}
{%- endmacro %}

{% macro main_menu(menu_items, page_name, categories, show_search, site_url) -%}
  <div>{{ site_url }}</div>
  <ul class="navbar-nav nav">
    {% for menu_item in menu_items %}
      <li class="nav-item main-menu__item">
        <a class="nav-link main-menu__link" href="{{ menu_item_href(menu_item, page_name, categories, site_url) }}">{{ menu_item.label }}</a>
      </li>
    {% endfor %}
    {% if show_search %}
      <li>
        <form class="form-inline my-2 my-lg-0">
          <div class="search-box">
            <i class="fa fa-search"></i>
            <input type="text" class="form-control" placeholder="Search site" aria-label="Search site" aria-describedby="search-button">
          </div>
        </form>
      </li>
    {% endif %}
  </ul>
{%- endmacro %}
